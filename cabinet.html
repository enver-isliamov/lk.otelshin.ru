<script>
function getQueryParams() {
  const params = {};
  const search = new URLSearchParams(window.location.search);
  for (const [key, val] of search.entries()) {
    params[key] = val;
  }
  return params;
}

function validateTelegramAuth(params) {
  const botToken = 'YOUR_BOT_TOKEN'; // НЕ вставляй прямо в JS на фронте, это небезопасно
  const dataCheckString = Object.keys(params)
    .filter(k => k !== 'hash')
    .sort()
    .map(k => `${k}=${params[k]}`)
    .join('\n');

  const secretKey = CryptoJS.HmacSHA256(botToken, 'WebAppData'); // библиотека crypto-js
  const computedHash = CryptoJS.HmacSHA256(dataCheckString, secretKey).toString(CryptoJS.enc.Hex);

  return computedHash === params.hash;
}

const params = getQueryParams();
if (!params.id) {
  document.body.innerText = 'Ошибка: Telegram авторизация не прошла.';
} else {
  // Дополнительно можно проверить подпись (hash)
  // validateTelegramAuth(params);

  // Вывести пользователя
  document.body.innerHTML = `<h2>Здравствуйте, ${params.first_name}!</h2><p>Ваш ID: ${params.id}</p>`;
  // Далее можно подгрузить заказ через chat_id и т.п.
}
</script>
